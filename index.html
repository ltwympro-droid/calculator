<!DOCTYPE html>
<html lang="uk">
<head>
<meta charset="UTF-8">
<title>єОселя / USL v1.5 Admin</title>

<style>
body{font-family:Arial;background:#f3f5fa;padding:30px;}
.container{max-width:760px;background:white;padding:26px;border-radius:14px;box-shadow:0 8px 25px rgba(0,0,0,.08);}
.block{margin-top:16px;}
label{font-weight:bold;display:flex;justify-content:space-between;}
input[type=range],input[type=number]{width:100%;}
.result{margin-top:22px;background:#eef3ff;padding:16px;border-radius:10px;}
.admin{background:#fff4e5;padding:14px;border-radius:10px;margin-top:18px;display:none;}
.bad{color:#c40000;font-weight:bold;}
.ok{color:#0a7a2f;font-weight:bold;}
button{padding:8px 12px;border-radius:8px;border:none;background:#0a84ff;color:white;cursor:pointer;margin-top:6px;}
.small{font-size:13px;color:#666;}
</style>
</head>

<body>
<div class="container">

<h2>єОселя / USL калькулятор v1.5</h2>

<button onclick="adminLogin()">Адмін режим</button>
<button onclick="window.print()">PDF</button>

<!-- CLIENT CONTROLS -->

<div class="block">
<label>Склад сімʼї <span id="famVal"></span></label>
<input type="range" id="fam" min="1" max="6" value="2">
</div>

<div class="block">
<label>Площа <span id="areaVal"></span></label>
<input type="range" id="area" min="20" max="150" value="60">
</div>

<div class="block">
<label>Ціна за м² <span id="m2Val"></span></label>
<input type="range" id="m2" min="25000" max="120000" step="1000" value="65000">
</div>

<div class="block">
<label>Перший внесок % <span id="downVal"></span></label>
<input type="range" id="down" min="10" max="80" value="25">
</div>

<div class="block">
<label>Ставка</label>
<select id="rate">
<option value="3">3%</option>
<option value="7">7%</option>
</select>
</div>

<div class="block">
<label>Термін <span id="yearsVal"></span></label>
<input type="range" id="years" min="5" max="30" value="20">
</div>

<!-- ADMIN PANEL -->

<div class="admin" id="adminBox">
<h3>Адмін налаштування</h3>

<label>Базова опосередкована вартість м²</label>
<input type="number" id="baseM2" value="30081">

<label>Коефіцієнт програми</label>
<input type="number" id="coef" value="2" step="0.1">

<label>Допуск %</label>
<input type="number" id="extraPct" value="10">

<label>Мін перший внесок %</label>
<input type="number" id="minDown" value="20">

<label>Ліміт кредиту банку</label>
<input type="number" id="bankCap" value="3000000">

<button onclick="calc()">Застосувати</button>
</div>

<div class="result" id="out"></div>

</div>

<script>
const PIN="1357"; // зміниш сам

function adminLogin(){
 let p=prompt("PIN:");
 if(p===PIN){
  document.getElementById("adminBox").style.display="block";
 }
}

const id=x=>document.getElementById(x);
const fmt=n=>Number(n).toLocaleString("uk-UA");

["fam","area","m2","down","rate","years",
 "baseM2","coef","extraPct","minDown","bankCap"]
.forEach(x=>id(x).oninput=calc);

function calc(){

 let fam=+id("fam").value;
 let area=+id("area").value;
 let m2=+id("m2").value;
 let downP=+id("down").value;
 let rate=+id("rate").value;
 let years=+id("years").value;

 let base=+id("baseM2").value;
 let coef=+id("coef").value;
 let extra=+id("extraPct").value/100;
 let minDown=+id("minDown").value;
 let cap=+id("bankCap").value;

 let norm=fam<=2?52.5:52.5+(fam-2)*21;
 let maxArea=Math.min(norm*(1+extra),115.5);

 let limitM2=base*coef*(1+extra);
 let maxPrice=limitM2*norm;

 let price=area*m2;
 let downSum=price*downP/100;
 let loan=price-downSum;

 let mr=rate/100/12;
 let months=years*12;

 let pay = loan*(mr*Math.pow(1+mr,months)) /
          (Math.pow(1+mr,months)-1);

 let okArea=area<=maxArea;
 let okM2=m2<=limitM2;
 let okPrice=price<=maxPrice;
 let okDown=downP>=minDown;
 let okLoan=loan<=cap;

 let fit=okArea&&okM2&&okPrice&&okDown&&okLoan;

 id("famVal").innerHTML=fam;
 id("areaVal").innerHTML=area+" м²";
 id("m2Val").innerHTML=fmt(m2);
 id("downVal").innerHTML=downP+"%";
 id("yearsVal").innerHTML=years+" років";

 id("out").innerHTML=`
 ${fit?'<div class="ok">✅ Проходить</div>':'<div class="bad">❌ Не проходить</div>'}
 <hr>
 Ціна: ${fmt(price)} грн<br>
 Внесок: ${fmt(downSum)} грн<br>
 Кредит: ${fmt(loan)} грн<br>
 Платіж: ${fmt(pay.toFixed(0))} грн<br>

 <div class="small">
 Ліміт м²: ${fmt(limitM2)}<br>
 Макс ціна: ${fmt(maxPrice.toFixed(0))}<br>
 Ліміт банку: ${fmt(cap)}
 </div>
 `;
}

calc();
</script>

</body>
</html>
